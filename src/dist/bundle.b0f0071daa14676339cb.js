/*! For license information please see bundle.b0f0071daa14676339cb.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var s;e.g.importScripts&&(s=e.g.location+"");var t=e.g.document;if(!s&&t&&(t.currentScript&&(s=t.currentScript.src),!s)){var a=t.getElementsByTagName("script");a.length&&(s=a[a.length-1].src)}if(!s)throw new Error("Automatic publicPath is not supported in this browser");s=s.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=s})();const s=document.querySelector(":root"),t=getComputedStyle(s),a={"--board-color":t.getPropertyValue("--board-color"),"--snake-color":t.getPropertyValue("--snake-color"),"--tile-color":t.getPropertyValue("--tile-color"),"--background":t.getPropertyValue("--background"),"--food-color":t.getPropertyValue("--food-color"),"--text-color":t.getPropertyValue("--text-color")};let o={boardColor:localStorage.getItem("board-theme")||a["--board-color"],snakeColor:localStorage.getItem("snake-color")||a["--snake-color"],tileColor:localStorage.getItem("tile-color")||a["--tile-color"],foodColor:localStorage.getItem("food-color")||a["--food-color"],background:localStorage.getItem("background")||a["--background"]};const l=class{constructor(e){this.board=e,s.style.setProperty("--board-color",this.board.boardColor),s.style.setProperty("--text-color",this.board.textColor),s.style.setProperty("--snake-color",this.board.snakeColor),s.style.setProperty("--background",this.board.background),s.style.setProperty("--food-color",this.board.foodColor),s.style.setProperty("--tile-color",this.board.tileColor)}handlePickTheme=({theme:e})=>{const{textColor:t,boardColor:a,tileColor:o,background:l,foodColor:r,snakeColor:c}=e;s.style.setProperty("--board-color",a),s.style.setProperty("--text-color",t),s.style.setProperty("--snake-color",c),s.style.setProperty("--background",l),s.style.setProperty("--food-color",r),s.style.setProperty("--tile-color",o),localStorage.setItem("--board-color",a),localStorage.setItem("--text-color",t),localStorage.setItem("--snake-color",c),localStorage.setItem("--background",l),localStorage.setItem("--food-color",r),localStorage.setItem("--tile-color",o)};handleNystagmus=()=>{let e,t=!1;e=setInterval((()=>{t=!t,s.style.setProperty("--tile-color",t?"#fff":"#000"),s.style.setProperty("--snake-color",t?"#000":"#fff"),s.style.setProperty("--food-color",t?"#f00":"#00f")}),50),setTimeout((()=>{s.style.setProperty("--snake-color",this.board.snakeColor),s.style.setProperty("--tile-color",this.board.tileColor),s.style.setProperty("--food-color",this.board.foodColor),clearInterval(e)}),4e3)}},r=e.p+"assets/point.a41846ef811ebc769132d677a9d33a21.mp3",c=e.p+"assets/gameover.0242c96fc833693dc721ea75ebb2d1b4.wav",n=e.p+"assets/speed_acceleration.952b0801786b04a70a0133de0ce831a6.wav",i=e.p+"assets/jump.ae2de8e7e136703f362699ea22c8a8c5.wav",d=e.p+"assets/start.105e220c664c62490ce0c19c670010fc.wav",u=new Audio,p=new Audio,m=new Audio,y=new Audio,b=new Audio,h=new Audio,f=({min:e,max:s})=>(e=Math.ceil(e),s=Math.floor(s),Math.floor(Math.random()*(s-e+1))+e),g=class{constructor(e,s,t,a,o,l=0){this.direction=e,this.length=s,this.speed=t,this.x=a,this.y=o,this.jumps=l}},k=[],v={min:10,max:40};let x=(()=>{let e;for(;!e||e<v.min||e>v.max;){const s=prompt(`Podaj wielkość planszy (minimalna - ${v.min}, maksymalna - ${v.max}):`);e=parseInt(s),(!e||e<v.min||e>v.max)&&alert("Wprowadź poprawną wartość!")}return e})(),L={class:"",set:({payload:e,attr:s})=>{s?L.class[s]=e:L.class=e}},w={class:"",set:({payload:e,attr:s})=>{s?w.class[s]=e:w.class=e}},S={val:!1,set:e=>{S.val=e}};const I=[];let P={time:0,increment:()=>{P.time++}},M={isMuted:!1,toggle:()=>{M.isMuted=!M.isMuted}},C={val:0,set:e=>{C.val=e}},E={interval:"",set:e=>{E.interval=e}},A={interval:"",set:e=>{A.interval=e}},D={state:!1,set:e=>{D.state=e}};const T=document.querySelector("[data-parameter=time]"),q=document.querySelector("[data-parameter=board-size]"),$=document.querySelector("[data-parameter=speed]"),z=document.querySelector("[data-parameter=length]"),X=(document.querySelector("[data-direction=top]"),document.querySelector("[data-direction=bottom]"),document.querySelector("[data-direction=left]"),document.querySelector("[data-direction=right]"),document.querySelector(".gameboard")),F=document.querySelector(".sound"),H=document.querySelectorAll(".control"),j=({snakeLength:e,speed:s,timer:t,boardSize:a})=>{s&&($.textContent=`${s}`),e&&(z.textContent=`${e}`),a&&(q.textContent=`Rozmiar planszy: ${a}x${a}`),t&&(T.textContent=`Czas gry: \n    ${Math.floor(t/60/60)<10?"0"+Math.floor(t/60/60):Math.floor(t/60/60)}:${Math.floor(t/60)%60<10?"0"+Math.floor(t/60)%60:Math.floor(t/60)%60}:${t%60<10?"0"+t%60:t%60}\n    `)},N=class{constructor(e,s,t=""){this.name=t,this.x=e,this.y=s}},W=()=>{clearInterval(A.interval),clearInterval(E.interval),S.val=!1,L.class.length,L.class.jumps,Math.floor(P.time/60/60),Math.floor(P.time/60),P.time,M.isMuted||b.play()},R=()=>{const{x:e,y:s}=I[0],{x:t,y:a}=I[1]?I[1]:{x:void 0,y:void 0};if(!t||!a){let t={x:0,y:0};switch(L.class.direction){case"W":t.x=e,t.y=s+1;break;case"S":t.x=e,t.y=s-1;break;case"A":t.x=e+1,t.y=s;break;case"D":t.x=e-1,t.y=s}return{newX:t.x,newY:t.y}}return((e,s,t,a)=>{let o=t,l=a;return 0!==e?o=(t-e+x)%x:0!==s&&(l=(a-s+x)%x),k[l][o].classList.contains("tile--snake")?(W(),{newX:o,newY:l}):{newX:o,newY:l}})(t-e,a-s,e,s)},B=class extends N{handleIsEaten=()=>{if(L.class.x===this.x&&L.class.y===this.y){M.isMuted||y.play(),k[this.y][this.x].classList.remove("tile--food"),ie({mode:"food"});const{newX:e,newY:s}=R();if(!S.val)return;L.class.length++,j({snakeLength:L.class.length}),z.style.color="#d1d122",I.unshift({x:e,y:s}),k[s][e].classList.add("tile--snake"),setTimeout((()=>{z.style.color="#000"}),300)}}};let V={class:"",set:({payload:e,attr:s})=>{s?V.class[s]=e:V.class=e}};const Y=V,O=({type:e})=>{switch(e){case"Nystagmus":Y.class.handleNystagmus();break;case"+5 points":setTimeout((()=>{for(let e=0;e<5;e++){let{x:s,y:t}=I[e];if(!k[t][s].classList.contains("tile--snake-added-point"))break;k[t][s].classList.remove("tile--snake-added-point")}}),500);for(let e=0;e<5;e++){const{x:e,y:s}=I[0],t=k[s][e];if(!t.classList.contains("tile--snake-subtracted-point"))break;t.classList.remove("tile--snake-subtracted-point"),t.classList.remove("tile--snake"),I.shift(),L.class.length--}for(let e=0;e<5;e++){const e=R();if(!S.val)return;if(e){const{newX:s,newY:t}=e;L.class.length++,j({snakeLength:L.class.length}),I.unshift({x:s,y:t}),k[t][s].classList.add("tile--snake"),k[t][s].classList.add("tile--snake-added-point")}}break;case"-5 points":setTimeout((()=>{for(let e=0;e<5;e++){const{x:e,y:s}=I[0],t=k[s][e];if(!t.classList.contains("tile--snake-subtracted-point"))break;t.classList.remove("tile--snake-subtracted-point"),t.classList.remove("tile--snake"),I.shift(),L.class.length--,j({snakeLength:L.class.length})}}),500);for(let e=0;e<5;e++){const{x:s,y:t}=I[e];if(k[t][s].classList.contains("tile--snake-added-point"))k[t][s].classList.remove("tile--snake-added-point"),k[t][s].classList.add("tile--snake-subtracted-point");else{if(e===I.length-1)break;k[t][s].classList.add("tile--snake-subtracted-point")}}break;default:console.error("#ERR -> Nieznany typ bonusu!")}},_=e.p+"assets/SPEED2X.a0b832dac35442350bb1bb4991ad026a.png",G=e.p+"assets/SPEED2X.6f08f0072702c6c59080b722c5f0dc75.wav",J=e.p+"assets/SPEED 2Xlower.6b0fb71db10e1572f729df1326977064.png",K=e.p+"assets/SPEED 2Xlower.76cbfa994f82f5d79a896f2e339f2201.wav",Q=e.p+"assets/Freeze.b1c4bc1b6fb900ad64e0c38c0c7936fc.png",U=e.p+"assets/Freeze.aaa39c866733aa62071d1ff78902879d.mp3",Z=e.p+"assets/Bombs.77406599539cf7a19113ed07321eb7fd.png",ee=e.p+"assets/bombs.529b8944e83780d8ea9f3dbbdb60897f.wav",se=e.p+"assets/+5 points.ce2d94cfc6b2159165532daeb96a5333.wav",te=e.p+"assets/-5 points.ec530168190110448115828c53954685.wav",ae=e.p+"assets/+5 points.07303cf152a20326af798466984eb1bb.png",oe=e.p+"assets/-5 points.870d2a49ad6d668e42239fd94a285a98.png",le={"SPEED 2X":{img:_,audio:G},"SPEED /2X":{img:J,audio:K},Freeze:{img:Q,audio:U},Bombs:{img:Z,audio:ee},Nystagmus:{img:e.p+"assets/Nystagmus.3c7308038ea90a21aa7568a94fc117d7.png",audio:e.p+"assets/nystagmus.445799472810c8e69c180d7da2933ba0.wav"},"+5 points":{img:ae,audio:se},"-5 points":{img:oe,audio:te}},re=[],ce=[{name:"SPEED 2X",probability:100},{name:"SPEED /2X",probability:100},{name:"Freeze",probability:100},{name:"Bombs",probability:100},{name:"Nystagmus",probability:100},{name:"+5 points",probability:100},{name:"-5 points",probability:100}],ne=class extends N{constructor(e,s,t,a,o,l){super(e,s,t),this.bonusID=a,this.imgPATH=o,this.audioPATH=l;const r=C.val*f({min:10,max:200})/100;this.boostInterval=setInterval(this.handleBonusTranslate,r)}handleBonusTranslate=()=>{if(S.val)if(k[this.y][this.x].classList.remove("tile--boost"),k[this.y][this.x].style.backgroundImage="",this.y++,this.x!==L.class.x||this.y!==L.class.y){if(this.y===x){const e=re.findIndex((e=>e.bonusID===this.bonusID));return clearInterval(this.boostInterval),void re.splice(e,1)}k[this.y][this.x].classList.add("tile--boost"),k[this.y][this.x].style.backgroundImage=`url('${le[this.name].img}')`}else{clearInterval(this.boostInterval),console.log("eaten -> bonus ate snake");const e=re.findIndex((e=>e.bonusID===this.bonusID));if(re.splice(e,1),O({type:this.name}),!M.isMuted){const e=new Audio;e.src=this.audioPATH,e.play()}}else clearInterval(this.boostInterval)}},ie=({mode:e,bonus:s})=>{if("bonus"===e){let e;s&&(e=new ne(0,0,s.name,re.length,s.imgPATH,s.audioPATH));const t=[];if(k[0].forEach(((e,s)=>{e.classList.contains("tile--boost")||e.classList.contains("tile--snake")||t.push(s)})),0===t.length)return;let a=f({min:0,max:t.length-1});return k[0][t[a]].classList.add("tile--boost"),k[0][t[a]].style.backgroundImage=`url('${e.imgPATH}')`,e.x=t[a],void re.push(e)}const t=document.querySelectorAll(".tile"),a=document.querySelectorAll(".tile:not(.tile--snake)"),o=f({min:0,max:a.length-1}),l=Array.from(t).indexOf(a[o]),r={x:l%x,y:Math.floor(l/x)},{x:c,y:n}=r;switch(e){case"food":w.class=new B(c,n),k[w.class.y][w.class.x].classList.add("tile--food");break;case"bomb":break;default:console.error("#ERR! -> Przesłano niepoprawny typ bonusu")}},de=()=>{y.src=r,b.src=c,m.src=n,p.src=i,u.src=d,u.volume=.07,p.volume=.1,y.volue=.07,m.volume=.3,b.volume=.3,h.volume=.3;let e={x:f({min:Math.floor(x/2)-3,max:Math.floor(x/2)+3}),y:f({min:Math.floor(x/2)-1,max:Math.floor(x/2)+1})};L.set({payload:new g(null,Math.round(x/3),1,e.x,e.y)}),j({boardSize:x,speed:L.class.speed.toFixed(2),snakeLength:L.class.length}),(e=>{let s=0;for(let t=0;t<x;t++){let t=[];for(let a=0;a<x;a++){let a=document.createElement("div");a.classList.add("tile"),a.style.width=e.width-2+"px",a.style.height=e.height-2+"px",X.appendChild(a);const o=document.querySelectorAll(".tile");t.push(o[s]),s++}k.push(t)}})({width:X.clientWidth/x,height:X.clientHeight/x}),(()=>{for(let e=0;e<L.class.length;e++){let s={x:L.class.x,y:L.class.y+e};I.unshift({x:s.x,y:s.y}),k[L.class.y+e][L.class.x].classList.add("tile--snake")}})(),ie({mode:"food"})},ue=()=>{if(w.class.handleIsEaten(),(()=>{let e;if(re.map(((s,t)=>{s.x===L.class.x&&s.y===L.class.y&&(e={bonus:s,index:t})})),e){const{bonus:s,index:t}=e;clearInterval(re[t].boostInterval),console.log("eaten -> snake ate bonus");const a=k[s.y][s.x];if(a.classList.remove("tile--boost"),a.style.backgroundImage="",console.log(re),re.splice(t,1),console.log(re),O({type:s.name}),!M.isMuted){const e=new Audio;e.src=s.audioPATH,e.play()}}})(),!S.val)return;const{x:e,y:s}=I[0];if(k[L.class.y][L.class.x].classList.contains("tile--snake"))return void W();const t=k[s][e];if(t.classList.contains("tile--snake-added-point")){for(let e=0;e<I.length;e++){const{x:s,y:t}=I[e],a=k[t][s];if(!a.classList.contains("tile--snake-added-point")){a.classList.add("tile--snake-added-point");break}}t.classList.remove("tile--snake-added-point")}else if(t.classList.contains("tile--snake-subtracted-point")){for(let e=0;e<I.length;e++){const{x:s,y:t}=I[e],a=k[t][s];if(!a.classList.contains("tile--snake-subtracted-point")){a.classList.add("tile--snake-subtracted-point");break}}t.classList.remove("tile--snake-subtracted-point")}k[s][e].classList.remove("tile--snake"),I.shift(),k[L.class.y][L.class.x].classList.add("tile--snake"),I.push({x:L.class.x,y:L.class.y})},pe=()=>{Math.random()<1&&0===re.length&&(()=>{const e=f({min:0,max:100}),s=[...ce.filter((s=>s.probability>=e))];for(const e of s)ie({mode:"bonus",bonus:{name:e.name,imgPATH:le[e.name].img,audioPATH:le[e.name].audio}})})(),(()=>{switch(L.class.direction){case"W":L.class.y=0===L.class.y?x-1:L.class.y-1,ue();break;case"S":L.class.y=L.class.y===x-1?0:L.class.y+1,ue();break;case"A":L.class.x=0===L.class.x?x-1:L.class.x-1,ue();break;case"D":L.class.x=L.class.x===x-1?0:L.class.x+1,ue();break;default:console.error("#ERR: Nieprawidłowy kierunek!")}})(),S.val&&(L.class.jumps++,(()=>{if(L.class.jumps%(9*Math.floor(x/10))==0){L.class.speed=parseFloat((L.class.speed+.1).toFixed(2));let e=parseFloat((L.class.speed/10).toFixed(3)),s=L.class.speed%e;console.log(L.class.speed,e,s),!M.isMuted&&(L.class.speed<2||L.class.speed>=2&&0===Math.floor(L.class.speed%(L.class.speed/10)))&&m.play(),$.classList.add("parameter-speed--acceleration"),j({speed:L.class.speed.toFixed(2)}),setTimeout((()=>{$.classList.remove("parameter-speed--acceleration")}),1e3),C.val=750/(x/v.max)/4/L.class.speed,clearInterval(E.interval),E.set(setInterval(pe,C.val))}})(),D.set(!0))},me=pe,ye=({key:e})=>{if("M"===e)return M.isMuted=!M.isMuted,void F.classList.toggle("sound--muted");"W"===e&&"S"===L.class.direction||"S"===e&&"W"===L.class.direction||"A"===e&&"D"===L.class.direction||"D"===e&&"A"===L.class.direction||(S.val||0!==L.class.jumps||("S"===e&&(I.reverse(),L.set({attr:"y",payload:I[I.length-1].y})),L.class.direction=e,S.val=!0,M.isMuted||u.play(),C.val=750/(x/v.max)/4/L.class.speed,E.set(setInterval(me,C.val)),A.set(setInterval((()=>{M.isMuted||p.play(),P.time++,j({timer:P.time})}),1e3))),S.val&&D.state&&(D.set(!1),L.class.direction=e))};let be;F.addEventListener("click",(()=>{M.isMuted=!M.isMuted,F.classList.toggle("sound--muted")})),H.forEach(((e,s)=>{e.addEventListener("touchstart",(()=>{e.classList.add("control--pressed")})),e.addEventListener("touchend",(()=>{e.classList.remove("control--pressed"),ye({key:["W","S","A","D"][s]})})),e.addEventListener("mousedown",(()=>{e.classList.add("control--pressed")})),e.addEventListener("mouseup",(()=>{e.classList.remove("control--pressed"),ye({key:["W","S","A","D"][s]})}))})),document.addEventListener("keydown",(e=>{switch(e.keyCode||e.key||e.keyIdentifier){case 87:case 38:H[0].classList.add("control--pressed");break;case 83:case 40:H[1].classList.add("control--pressed");break;case 65:case 37:H[2].classList.add("control--pressed");break;case 68:case 39:H[3].classList.add("control--pressed")}})),document.addEventListener("keyup",(e=>{let s=e.keyCode||e.key||e.keyIdentifier;switch(H.forEach((e=>e.classList.remove("control--pressed"))),s){case 87:case 38:be="W";break;case 83:case 40:be="S";break;case 65:case 37:be="A";break;case 68:case 39:be="D";break;case 77:be="M";break;default:return}ye({key:be})})),document.addEventListener("DOMContentLoaded",(()=>{Y.set({payload:new l({boardColor:o.boardColor,textColor:o.textColor,tileColor:o.tileColor,foodColor:o.foodColor,background:o.background,snakeColor:o.snakeColor})}),de()}))})();
//# sourceMappingURL=bundle.b0f0071daa14676339cb.js.map