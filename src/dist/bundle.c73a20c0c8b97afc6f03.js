/*! For license information please see bundle.c73a20c0c8b97afc6f03.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var s=e.g.document;if(!t&&s&&(s.currentScript&&(t=s.currentScript.src),!t)){var o=s.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=document.querySelector(":root"),s=getComputedStyle(t),o={"--board-color":s.getPropertyValue("--board-color"),"--snake-color":s.getPropertyValue("--snake-color"),"--tile-color":s.getPropertyValue("--tile-color"),"--background":s.getPropertyValue("--background"),"--food-color":s.getPropertyValue("--food-color"),"--text-color":s.getPropertyValue("--text-color")};let a={boardColor:localStorage.getItem("board-theme")||o["--board-color"],snakeColor:localStorage.getItem("snake-color")||o["--snake-color"],tileColor:localStorage.getItem("tile-color")||o["--tile-color"],foodColor:localStorage.getItem("food-color")||o["--food-color"],background:localStorage.getItem("background")||o["--background"]};const l=class{constructor(e){this.board=e,t.style.setProperty("--board-color",this.board.boardColor),t.style.setProperty("--text-color",this.board.textColor),t.style.setProperty("--snake-color",this.board.snakeColor),t.style.setProperty("--background",this.board.background),t.style.setProperty("--food-color",this.board.foodColor),t.style.setProperty("--tile-color",this.board.tileColor)}handlePickTheme=({theme:e})=>{const{textColor:s,boardColor:o,tileColor:a,background:l,foodColor:r,snakeColor:c}=e;t.style.setProperty("--board-color",o),t.style.setProperty("--text-color",s),t.style.setProperty("--snake-color",c),t.style.setProperty("--background",l),t.style.setProperty("--food-color",r),t.style.setProperty("--tile-color",a),localStorage.setItem("--board-color",o),localStorage.setItem("--text-color",s),localStorage.setItem("--snake-color",c),localStorage.setItem("--background",l),localStorage.setItem("--food-color",r),localStorage.setItem("--tile-color",a)};handleNystagmus=()=>{let e,s=!1;e=setInterval((()=>{s=!s,t.style.setProperty("--tile-color",s?"#fff":"#000"),t.style.setProperty("--snake-color",s?"#000":"#fff"),t.style.setProperty("--food-color",s?"#f00":"#00f")}),50),setTimeout((()=>{t.style.setProperty("--snake-color",this.board.snakeColor),t.style.setProperty("--tile-color",this.board.tileColor),t.style.setProperty("--food-color",this.board.foodColor),clearInterval(e)}),4e3)}},r=e.p+"assets/point.a41846ef811ebc769132d677a9d33a21.mp3",c=e.p+"assets/gameover.0242c96fc833693dc721ea75ebb2d1b4.wav",n=e.p+"assets/speed_acceleration.952b0801786b04a70a0133de0ce831a6.wav",i=e.p+"assets/jump.ae2de8e7e136703f362699ea22c8a8c5.wav",d=e.p+"assets/start.105e220c664c62490ce0c19c670010fc.wav",u=new Audio,p=new Audio,m=new Audio,y=new Audio,b=new Audio,h=new Audio,f=({min:e,max:t})=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),g=class{constructor(e,t,s,o,a,l=0){this.direction=e,this.length=t,this.speed=s,this.x=o,this.y=a,this.jumps=l}},v=[],k={min:10,max:40};let x=(()=>{let e;for(;!e||e<k.min||e>k.max;){const t=prompt(`Podaj wielkość planszy (minimalna - ${k.min}, maksymalna - ${k.max}):`);e=parseInt(t),(!e||e<k.min||e>k.max)&&alert("Wprowadź poprawną wartość!")}return e})(),w={class:"",set:({payload:e,attr:t})=>{t?w.class[t]=e:w.class=e}},S={class:"",set:({payload:e,attr:t})=>{t?S.class[t]=e:S.class=e}},I={val:!1,set:e=>{I.val=e}};const P=[];let L={time:0,increment:()=>{L.time++}},M={isMuted:!1,toggle:()=>{M.isMuted=!M.isMuted}},C={val:0,set:e=>{C.val=e}},E={interval:"",set:e=>{E.interval=e}},A={interval:"",set:e=>{A.interval=e}},D={state:!1,set:e=>{D.state=e}};const T=document.querySelector("[data-parameter=time]"),q=document.querySelector("[data-parameter=board-size]"),$=document.querySelector("[data-parameter=speed]"),z=document.querySelector("[data-parameter=length]"),F=(document.querySelector("[data-direction=top]"),document.querySelector("[data-direction=bottom]"),document.querySelector("[data-direction=left]"),document.querySelector("[data-direction=right]"),document.querySelector(".gameboard")),X=document.querySelector(".sound"),H=document.querySelectorAll(".control"),j=({snakeLength:e,speed:t,timer:s,boardSize:o})=>{t&&($.textContent=`${t}`),e&&(z.textContent=`${e}`),o&&(q.textContent=`Rozmiar planszy: ${o}x${o}`),s&&(T.textContent=`Czas gry: \n    ${Math.floor(s/60/60)<10?"0"+Math.floor(s/60/60):Math.floor(s/60/60)}:${Math.floor(s/60)%60<10?"0"+Math.floor(s/60)%60:Math.floor(s/60)%60}:${s%60<10?"0"+s%60:s%60}\n    `)},N=class{constructor(e,t,s=""){this.name=s,this.x=e,this.y=t}},R=()=>{clearInterval(A.interval),clearInterval(E.interval),I.val=!1,w.class.length,w.class.jumps,Math.floor(L.time/60/60),Math.floor(L.time/60),L.time,M.isMuted||b.play()},W=()=>{const{x:e,y:t}=P[0],{x:s,y:o}=P[1];return((e,t,s,o)=>{let a=s,l=o;if(0!==e?a=(s-e+x)%x:0!==t&&(l=(o-t+x)%x),!v[l][a].classList.contains("tile--snake"))return{newX:a,newY:l};R()})(s-e,o-t,e,t)},B=class extends N{handleIsEaten=()=>{if(w.class.x===this.x&&w.class.y===this.y){M.isMuted||y.play(),v[this.y][this.x].classList.remove("tile--food"),ie({mode:"food"});const{newX:e,newY:t}=W();if(!e||!t||!I.val)return;w.class.length++,j({snakeLength:w.class.length}),z.style.color="#d1d122",P.unshift({x:e,y:t}),v[t][e].classList.add("tile--snake"),setTimeout((()=>{z.style.color="#000"}),300)}}};let V={class:"",set:({payload:e,attr:t})=>{t?V.class[t]=e:V.class=e}};const Y=V,O=({type:e})=>{switch(e){case"Nystagmus":Y.class.handleNystagmus();break;case"+5 points":for(let e=0;e<5;e++){const e=W();if(e){const{newX:t,newY:s}=e;w.class.length++,P.unshift({x:t,y:s}),v[s][t].classList.add("tile--snake")}}j({snakeLength:w.class.length});break;case"-5 points":break;default:console.error("#ERR -> Nieznany typ bonusu!")}},_=e.p+"assets/SPEED2X.a0b832dac35442350bb1bb4991ad026a.png",G=e.p+"assets/SPEED2X.6f08f0072702c6c59080b722c5f0dc75.wav",J=e.p+"assets/SPEED 2Xlower.6b0fb71db10e1572f729df1326977064.png",K=e.p+"assets/SPEED 2Xlower.76cbfa994f82f5d79a896f2e339f2201.wav",Q=e.p+"assets/Freeze.b1c4bc1b6fb900ad64e0c38c0c7936fc.png",U=e.p+"assets/Freeze.aaa39c866733aa62071d1ff78902879d.mp3",Z=e.p+"assets/Bombs.77406599539cf7a19113ed07321eb7fd.png",ee=e.p+"assets/bombs.529b8944e83780d8ea9f3dbbdb60897f.wav",te=e.p+"assets/+5 points.ce2d94cfc6b2159165532daeb96a5333.wav",se=e.p+"assets/-5 points.ec530168190110448115828c53954685.wav",oe=e.p+"assets/+5 points.07303cf152a20326af798466984eb1bb.png",ae=e.p+"assets/-5 points.870d2a49ad6d668e42239fd94a285a98.png",le={"SPEED 2X":{img:_,audio:G},"SPEED /2X":{img:J,audio:K},Freeze:{img:Q,audio:U},Bombs:{img:Z,audio:ee},Nystagmus:{img:e.p+"assets/Nystagmus.3c7308038ea90a21aa7568a94fc117d7.png",audio:e.p+"assets/nystagmus.445799472810c8e69c180d7da2933ba0.wav"},"+5 points":{img:oe,audio:te},"-5 points":{img:ae,audio:se}},re=[],ce=[{name:"SPEED 2X",probability:100},{name:"SPEED /2X",probability:100},{name:"Freeze",probability:100},{name:"Bombs",probability:100},{name:"Nystagmus",probability:100},{name:"+5 points",probability:100},{name:"-5 points",probability:100}],ne=class extends N{constructor(e,t,s,o,a,l){super(e,t,s),this.bonusID=o,this.imgPATH=a,this.audioPATH=l;const r=C.val*f({min:10,max:200})/100;this.boostInterval=setInterval(this.handleBonusTranslate,r)}handleBonusTranslate=()=>{if(I.val){if(v[this.y][this.x].classList.remove("tile--boost"),v[this.y][this.x].style.backgroundImage="",this.y++,this.x===w.class.x&&this.y===w.class.y){clearInterval(this.boostInterval),console.log("eaten -> bonus ate snake");const e=re.findIndex((e=>e.bonusID===this.bonusID));return re.splice(e,1),O({type:this.name}),void(M.isMuted||(h.src=this.audioPATH,h.play()))}if(this.y===x){const e=re.findIndex((e=>e.bonusID===this.bonusID));return clearInterval(this.boostInterval),void re.splice(e,1)}v[this.y][this.x].classList.add("tile--boost"),v[this.y][this.x].style.backgroundImage=`url('${le[this.name].img}')`}else clearInterval(this.boostInterval)}},ie=({mode:e,bonus:t})=>{if("bonus"===e){let e;t&&(e=new ne(0,0,t.name,re.length,t.imgPATH,t.audioPATH));const s=[];if(v[0].forEach(((e,t)=>{e.classList.contains("tile--boost")||e.classList.contains("tile--snake")||s.push(t)})),0===s.length)return;let o=f({min:0,max:s.length-1});return v[0][s[o]].classList.add("tile--boost"),v[0][s[o]].style.backgroundImage=`url('${e.imgPATH}')`,e.x=s[o],void re.push(e)}const s=document.querySelectorAll(".tile"),o=document.querySelectorAll(".tile:not(.tile--snake)"),a=f({min:0,max:o.length-1}),l=Array.from(s).indexOf(o[a]),r={x:l%x,y:Math.floor(l/x)},{x:c,y:n}=r;switch(e){case"food":S.class=new B(c,n),v[S.class.y][S.class.x].classList.add("tile--food");break;case"bomb":break;default:console.error("#ERR! -> Przesłano niepoprawny typ bonusu")}},de=()=>{y.src=r,b.src=c,m.src=n,p.src=i,u.src=d,u.volume=.07,p.volume=.1,y.volue=.07,m.volume=.3,b.volume=.3,h.volume=.3;let e={x:f({min:Math.floor(x/2)-3,max:Math.floor(x/2)+3}),y:f({min:Math.floor(x/2)-1,max:Math.floor(x/2)+1})};w.set({payload:new g(null,Math.round(x/3),1,e.x,e.y)}),j({boardSize:x,speed:w.class.speed.toFixed(2),snakeLength:w.class.length}),(e=>{let t=0;for(let s=0;s<x;s++){let s=[];for(let o=0;o<x;o++){let o=document.createElement("div");o.classList.add("tile"),o.style.width=e.width-2+"px",o.style.height=e.height-2+"px",F.appendChild(o);const a=document.querySelectorAll(".tile");s.push(a[t]),t++}v.push(s)}})({width:F.clientWidth/x,height:F.clientHeight/x}),(()=>{for(let e=0;e<w.class.length;e++){let t={x:w.class.x,y:w.class.y+e};P.unshift({x:t.x,y:t.y}),v[w.class.y+e][w.class.x].classList.add("tile--snake")}})(),ie({mode:"food"})},ue=()=>{if(S.class.handleIsEaten(),(()=>{let e;if(re.map(((t,s)=>{t.x===w.class.x&&t.y===w.class.y&&(e={bonus:t,index:s})})),e){const{bonus:t,index:s}=e;clearInterval(re[s].boostInterval),console.log("eaten -> snake ate bonus");const o=v[t.y][t.x];o.classList.remove("tile--boost"),o.style.backgroundImage="",console.log(re),re.splice(s,1),console.log(re),O({type:t.name}),M.isMuted||(h.src=t.audioPATH,h.play())}})(),!I.val)return;const{x:e,y:t}=P[0];v[w.class.y][w.class.x].classList.contains("tile--snake")?R():(v[t][e].classList.remove("tile--snake"),P.shift(),v[w.class.y][w.class.x].classList.add("tile--snake"),P.push({x:w.class.x,y:w.class.y}))},pe=()=>{Math.random()<1&&0===re.length&&(()=>{const e=f({min:0,max:100}),t=[...ce.filter((t=>t.probability>=e))];for(const e of t)ie({mode:"bonus",bonus:{name:e.name,imgPATH:le[e.name].img,audioPATH:le[e.name].audio}})})(),(()=>{switch(w.class.direction){case"W":w.class.y=0===w.class.y?x-1:w.class.y-1,ue();break;case"S":w.class.y=w.class.y===x-1?0:w.class.y+1,ue();break;case"A":w.class.x=0===w.class.x?x-1:w.class.x-1,ue();break;case"D":w.class.x=w.class.x===x-1?0:w.class.x+1,ue();break;default:console.error("#ERR: Nieprawidłowy kierunek!")}})(),I.val&&(w.class.jumps++,(()=>{if(w.class.jumps%(9*Math.floor(x/10))==0){w.class.speed=parseFloat((w.class.speed+.1).toFixed(2));let e=parseFloat((w.class.speed/10).toFixed(3)),t=w.class.speed%e;console.log(w.class.speed,e,t),!M.isMuted&&(w.class.speed<2||w.class.speed>=2&&0===Math.floor(w.class.speed%(w.class.speed/10)))&&m.play(),$.classList.add("parameter-speed--acceleration"),j({speed:w.class.speed.toFixed(2)}),setTimeout((()=>{$.classList.remove("parameter-speed--acceleration")}),1e3),C.val=750/(x/k.max)/4/w.class.speed,clearInterval(E.interval),E.set(setInterval(pe,C.val))}})(),D.set(!0))},me=pe,ye=({key:e})=>{if("M"===e)return M.isMuted=!M.isMuted,void X.classList.toggle("sound--muted");"W"===e&&"S"===w.class.direction||"S"===e&&"W"===w.class.direction||"A"===e&&"D"===w.class.direction||"D"===e&&"A"===w.class.direction||(I.val||0!==w.class.jumps||("S"===e&&(P.reverse(),w.set({attr:"y",payload:P[P.length-1].y})),w.class.direction=e,I.val=!0,M.isMuted||u.play(),C.val=750/(x/k.max)/4/w.class.speed,E.set(setInterval(me,C.val)),A.set(setInterval((()=>{M.isMuted||p.play(),L.time++,j({timer:L.time})}),1e3))),I.val&&D.state&&(D.set(!1),w.class.direction=e))};let be;X.addEventListener("click",(()=>{M.isMuted=!M.isMuted,X.classList.toggle("sound--muted")})),H.forEach(((e,t)=>{e.addEventListener("mousedown",(()=>{e.classList.add("control--pressed")})),e.addEventListener("mouseup",(()=>{e.classList.remove("control--pressed"),ye({key:["W","S","A","D"][t]})}))})),document.addEventListener("keydown",(e=>{switch(e.keyCode||e.key||e.keyIdentifier){case 87:case 38:H[0].classList.add("control--pressed");break;case 83:case 40:H[1].classList.add("control--pressed");break;case 65:case 37:H[2].classList.add("control--pressed");break;case 68:case 39:H[3].classList.add("control--pressed")}})),document.addEventListener("keyup",(e=>{let t=e.keyCode||e.key||e.keyIdentifier;switch(H.forEach((e=>e.classList.remove("control--pressed"))),t){case 87:case 38:be="W";break;case 83:case 40:be="S";break;case 65:case 37:be="A";break;case 68:case 39:be="D";break;case 77:be="M";break;default:return}ye({key:be})})),document.addEventListener("DOMContentLoaded",(()=>{Y.set({payload:new l({boardColor:a.boardColor,textColor:a.textColor,tileColor:a.tileColor,foodColor:a.foodColor,background:a.background,snakeColor:a.snakeColor})}),de()}))})();
//# sourceMappingURL=bundle.c73a20c0c8b97afc6f03.js.map