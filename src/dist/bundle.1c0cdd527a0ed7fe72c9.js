/*! For license information please see bundle.1c0cdd527a0ed7fe72c9.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var s=e.g.document;if(!t&&s&&(s.currentScript&&(t=s.currentScript.src),!t)){var a=s.getElementsByTagName("script");a.length&&(t=a[a.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=document.querySelector(":root"),s=getComputedStyle(t),a={"--board-color":s.getPropertyValue("--board-color"),"--snake-color":s.getPropertyValue("--snake-color"),"--tile-color":s.getPropertyValue("--tile-color"),"--background":s.getPropertyValue("--background"),"--food-color":s.getPropertyValue("--food-color"),"--text-color":s.getPropertyValue("--text-color")};let o={boardColor:localStorage.getItem("board-theme")||a["--board-color"],snakeColor:localStorage.getItem("snake-color")||a["--snake-color"],tileColor:localStorage.getItem("tile-color")||a["--tile-color"],foodColor:localStorage.getItem("food-color")||a["--food-color"],background:localStorage.getItem("background")||a["--background"]};const l=class{constructor(e){this.board=e,t.style.setProperty("--board-color",this.board.boardColor),t.style.setProperty("--text-color",this.board.textColor),t.style.setProperty("--snake-color",this.board.snakeColor),t.style.setProperty("--background",this.board.background),t.style.setProperty("--food-color",this.board.foodColor),t.style.setProperty("--tile-color",this.board.tileColor)}handlePickTheme=({theme:e})=>{const{textColor:s,boardColor:a,tileColor:o,background:l,foodColor:r,snakeColor:n}=e;t.style.setProperty("--board-color",a),t.style.setProperty("--text-color",s),t.style.setProperty("--snake-color",n),t.style.setProperty("--background",l),t.style.setProperty("--food-color",r),t.style.setProperty("--tile-color",o),localStorage.setItem("--board-color",a),localStorage.setItem("--text-color",s),localStorage.setItem("--snake-color",n),localStorage.setItem("--background",l),localStorage.setItem("--food-color",r),localStorage.setItem("--tile-color",o)};handleNystagmus=()=>{let e,s=!1;e=setInterval((()=>{s=!s,t.style.setProperty("--tile-color",s?"#fff":"#000"),t.style.setProperty("--snake-color",s?"#000":"#fff"),t.style.setProperty("--food-color",s?"#f00":"#00f")}),50),setTimeout((()=>{t.style.setProperty("--snake-color",this.board.snakeColor),t.style.setProperty("--tile-color",this.board.tileColor),t.style.setProperty("--food-color",this.board.foodColor),clearInterval(e)}),4e3)}},r=e.p+"assets/point.a41846ef811ebc769132d677a9d33a21.mp3",n=e.p+"assets/gameover.0242c96fc833693dc721ea75ebb2d1b4.wav",i=e.p+"assets/speed_acceleration.952b0801786b04a70a0133de0ce831a6.wav",c=e.p+"assets/jump.ae2de8e7e136703f362699ea22c8a8c5.wav",d=e.p+"assets/start.105e220c664c62490ce0c19c670010fc.wav",u=({min:e,max:t})=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),m=[],p={min:10,max:40};let b=(()=>{let e;for(;!e||e<p.min||e>p.max;){const t=prompt(`Podaj wielkość planszy (minimalna - ${p.min}, maksymalna - ${p.max}):`);e=parseInt(t),(!e||e<p.min||e>p.max)&&alert("Wprowadź poprawną wartość!")}return e})(),y={class:"",set:({payload:e,attr:t})=>{t?y.class[t]=e:y.class=e}},h={class:"",set:({payload:e,attr:t})=>{t?h.class[t]=e:h.class=e}},f={val:!1,set:e=>{f.val=e}};const g=[];let k={time:0,increment:()=>{k.time++}},v={isMuted:!1,toggle:()=>{v.isMuted=!v.isMuted}},x={val:0,set:e=>{x.val=e}},L={interval:"",set:e=>{L.interval=e}},w={interval:"",set:e=>{w.interval=e}},I={state:!1,set:e=>{I.state=e}};const S=class{constructor(e,t,s=""){this.name=s,this.x=e,this.y=t}},P=document.querySelector("[data-parameter=time]"),C=document.querySelector("[data-parameter=board-size]"),M=document.querySelector("[data-parameter=speed]"),E=document.querySelector("[data-parameter=length]"),A=(document.querySelector("[data-direction=top]"),document.querySelector("[data-direction=bottom]"),document.querySelector("[data-direction=left]"),document.querySelector("[data-direction=right]"),document.querySelector(".gameboard")),T=document.querySelector(".sound"),D=document.querySelectorAll(".control"),q=({snakeLength:e,speed:t,timer:s,boardSize:a})=>{t&&(M.textContent=`${t}`),e&&(E.textContent=`${e}`),a&&(C.textContent=`Rozmiar planszy: ${a}x${a}`),s&&(P.textContent=`Czas gry: \n    ${Math.floor(s/60/60)<10?"0"+Math.floor(s/60/60):Math.floor(s/60/60)}:${Math.floor(s/60)%60<10?"0"+Math.floor(s/60)%60:Math.floor(s/60)%60}:${s%60<10?"0"+s%60:s%60}\n    `)},$=()=>{clearInterval(w.interval),clearInterval(L.interval),f.val=!1,y.class.length,y.class.jumps,Math.floor(k.time/60/60),Math.floor(k.time/60),k.time,setTimeout((()=>{navigator.vibrate([200,100,300])}),150),v.isMuted||me.play()},z=()=>{const{x:e,y:t}=g[0],{x:s,y:a}=g[1]?g[1]:{x:void 0,y:void 0};if(!s||!a){let s={x:0,y:0};switch(y.class.direction){case"W":s.x=e,s.y=t+1;break;case"S":s.x=e,s.y=t-1;break;case"A":s.x=e+1,s.y=t;break;case"D":s.x=e-1,s.y=t}return{newX:s.x,newY:s.y}}return((e,t,s,a)=>{let o=s,l=a;return 0!==e?o=(s-e+b)%b:0!==t&&(l=(a-t+b)%b),m[l][o].classList.contains("tile--snake")?($(),{newX:o,newY:l}):{newX:o,newY:l}})(s-e,a-t,e,t)},B=class extends S{handleIsEaten=()=>{if(y.class.x===this.x&&y.class.y===this.y){v.isMuted||ue.play(),m[this.y][this.x].classList.remove("tile--food"),Y({mode:"food"});const{newX:e,newY:t}=z();if(!f.val)return;let s=g.length;const{x:a,y:o}=g[0],l=m[o][a];if(l.classList.contains("tile--snake-added-point"))for(let e=0;e<s;e++){const{x:t,y:s}=g[e];m[s][t].classList.remove("tile--snake-added-point")}else if(l.classList.contains("tile--snake-subtracted-point"))for(let e=0;e<s;e++){const{x:e,y:t}=g[0],s=m[t][e];if(!s.classList.contains("tile--snake-subtracted-point"))break;s.classList.remove("tile--snake-subtracted-point"),s.classList.remove("tile--snake"),g.shift(),y.class.length--}y.class.length++,q({snakeLength:y.class.length}),E.style.color="#d1d122",g.unshift({x:e,y:t}),m[t][e].classList.add("tile--snake"),setTimeout((()=>{E.style.color="#000"}),300)}}};let X={class:"",set:({payload:e,attr:t})=>{t?X.class[t]=e:X.class=e}};const F=X,H=[];let j={state:!0,toggle:()=>{j.state=!j.state}},N={val:"",set:({payload:e})=>{N.val=e}};const W=({type:e})=>{let s;switch(e){case"Nystagmus":F.class.handleNystagmus();break;case"+5 points":setTimeout((()=>{let e=g.length;for(let t=0;t<e;t++){let{x:e,y:s}=g[t];if(!m[s][e].classList.contains("tile--snake-added-point"))break;m[s][e].classList.remove("tile--snake-added-point")}}),500),s=g.length;for(let e=0;e<s;e++){const{x:e,y:t}=g[0],s=m[t][e];if(!s.classList.contains("tile--snake-subtracted-point"))break;s.classList.remove("tile--snake-subtracted-point"),s.classList.remove("tile--snake"),g.shift(),y.class.length--}for(let e=0;e<5;e++){const e=z();if(!f.val)return;if(e){const{newX:t,newY:s}=e;y.class.length++,q({snakeLength:y.class.length}),g.unshift({x:t,y:s}),m[s][t].classList.add("tile--snake"),m[s][t].classList.add("tile--snake-added-point")}}break;case"-5 points":setTimeout((()=>{let e=g.length;for(let t=0;t<e;t++){const{x:e,y:t}=g[0],s=m[t][e];if(!s.classList.contains("tile--snake-subtracted-point"))break;s.classList.remove("tile--snake-subtracted-point"),s.classList.remove("tile--snake"),g.shift(),y.class.length--,q({snakeLength:y.class.length})}}),500);for(let e=0;e<5;e++){const{x:t,y:s}=g[e];if(m[s][t].classList.contains("tile--snake-added-point"))m[s][t].classList.remove("tile--snake-added-point"),m[s][t].classList.add("tile--snake-subtracted-point");else{if(e===g.length-1)break;m[s][t].classList.add("tile--snake-subtracted-point")}}break;case"Bombs":N.set({payload:setInterval((()=>{j.toggle(),t.style.setProperty("--bomb-color",j.state?"#000":"#f00")}),250)});for(let e=0;e<8;e++)Y({mode:"bomb"});break;default:console.error("#ERR -> Nieznany typ bonusu!")}},R=class extends S{constructor(e,t,s,a,o,l){super(e,t,s),this.bonusID=a,this.imgPATH=o,this.audioPATH=l;const r=x.val*u({min:10,max:200})/100;this.boostInterval=setInterval(this.handleBonusTranslate,r)}handleBonusTranslate=()=>{if(f.val)if(m[this.y][this.x].classList.remove("tile--boost"),m[this.y][this.x].style.backgroundImage="",this.y++,this.x!==y.class.x||this.y!==y.class.y){if(this.y===b){const e=re.findIndex((e=>e.bonusID===this.bonusID));return clearInterval(this.boostInterval),void re.splice(e,1)}m[this.y][this.x].classList.add("tile--boost"),m[this.y][this.x].style.backgroundImage=`url('${oe[this.name].img}')`}else{clearInterval(this.boostInterval),console.log("eaten -> bonus ate snake");const e=re.findIndex((e=>e.bonusID===this.bonusID));if(re.splice(e,1),W({type:this.name}),!v.isMuted){const e=new Audio;e.src=this.audioPATH,e.play()}}else clearInterval(this.boostInterval)}},V=class extends S{constructor(e,t){super(e,t),this.bombId=le.length,le.push(this);const s=u({min:50,max:250});this.bombInterval=setInterval(this.handleBombTranslate,s)}handleBombTranslate=()=>{if(f.val){if(m[this.y][this.x].classList.remove("tile--bomb"),0===this.x)return clearInterval(this.bombInterval),le.splice(this.bombId,1),void(0===le.length&&clearInterval(N.val));this.x--,m[this.y][this.x].classList.add("tile--bomb"),this.handleBombCollide()}else clearInterval(this.bombInterval)};handleBombCollide=()=>{this.x===y.class.x&&this.y===y.class.y&&(v.isMuted||be.play(),le.splice(this.bombId,1),0===le.length&&clearInterval(N.val),$())}},Y=({mode:e,bonus:t})=>{if("bonus"===e){let e;t&&(e=new R(0,0,t.name,re.length,t.imgPATH,t.audioPATH));const s=[];if(m[0].forEach(((e,t)=>{e.classList.contains("tile--boost")||e.classList.contains("tile--snake")||s.push(t)})),0===s.length)return;let a=u({min:0,max:s.length-1});return m[0][s[a]].classList.add("tile--boost"),m[0][s[a]].style.backgroundImage=`url('${e.imgPATH}')`,e.x=s[a],void re.push(e)}const s=document.querySelectorAll(".tile"),a=document.querySelectorAll(".tile:not(.tile--snake)"),o=u({min:0,max:a.length-1}),l=Array.from(s).indexOf(a[o]),r={x:l%b,y:Math.floor(l/b)},{x:n,y:i}=r;switch(e){case"food":h.class=new B(n,i),m[h.class.y][h.class.x].classList.add("tile--food");break;case"bomb":const e=[];for(let t=0;t<b;t++){const s=m[t][b-1];s.classList.contains("tile--snake")||s.classList.contains("tile--food")||e.push(t)}if(0===e.length)return;let t=u({min:0,max:e.length-1});m[t][b-1].classList.add("tile--bomb"),new V(b-1,e[t]);break;default:console.error("#ERR! -> Przesłano niepoprawny typ bonusu")}},O=e.p+"assets/SPEED2X.a0b832dac35442350bb1bb4991ad026a.png",_=e.p+"assets/SPEED2X.6f08f0072702c6c59080b722c5f0dc75.wav",G=e.p+"assets/SPEED 2Xlower.6b0fb71db10e1572f729df1326977064.png",J=e.p+"assets/SPEED 2Xlower.76cbfa994f82f5d79a896f2e339f2201.wav",K=e.p+"assets/Freeze.b1c4bc1b6fb900ad64e0c38c0c7936fc.png",Q=e.p+"assets/Freeze.aaa39c866733aa62071d1ff78902879d.mp3",U=e.p+"assets/Bombs.77406599539cf7a19113ed07321eb7fd.png",Z=e.p+"assets/bombs.529b8944e83780d8ea9f3dbbdb60897f.wav",ee=e.p+"assets/+5 points.ce2d94cfc6b2159165532daeb96a5333.wav",te=e.p+"assets/-5 points.ec530168190110448115828c53954685.wav",se=e.p+"assets/+5 points.07303cf152a20326af798466984eb1bb.png",ae=e.p+"assets/-5 points.870d2a49ad6d668e42239fd94a285a98.png",oe={"SPEED 2X":{img:O,audio:_},"SPEED /2X":{img:G,audio:J},Freeze:{img:K,audio:Q},Bombs:{img:U,audio:Z},Nystagmus:{img:e.p+"assets/Nystagmus.3c7308038ea90a21aa7568a94fc117d7.png",audio:e.p+"assets/nystagmus.445799472810c8e69c180d7da2933ba0.wav"},"+5 points":{img:se,audio:ee},"-5 points":{img:ae,audio:te}},le=[],re=[],ne=[{name:"SPEED 2X",probability:70},{name:"SPEED /2X",probability:20},{name:"Freeze",probability:60},{name:"Bombs",probability:100},{name:"Nystagmus",probability:15},{name:"+5 points",probability:25},{name:"-5 points",probability:80}],ie=new Audio,ce=new Audio,de=new Audio,ue=new Audio,me=new Audio,pe=new Audio,be=new Audio,ye=class{constructor(e,t,s,a,o,l=0){this.direction=e,this.length=t,this.speed=s,this.x=a,this.y=o,this.jumps=l}},he=()=>{ue.src=r,me.src=n,de.src=i,ce.src=c,ie.src=d,be.src=oe.Bombs,be.volume=.1,ie.volume=.07,ce.volume=.1,ue.volue=.07,de.volume=.3,me.volume=.3,pe.volume=.1;let e={x:u({min:Math.floor(b/2)-3,max:Math.floor(b/2)+3}),y:u({min:Math.floor(b/2)-1,max:Math.floor(b/2)+1})};y.set({payload:new ye(null,Math.round(b/3),1,e.x,e.y)}),q({boardSize:b,speed:y.class.speed.toFixed(2),snakeLength:y.class.length}),(e=>{let t=0;for(let s=0;s<b;s++){let s=[];for(let a=0;a<b;a++){let a=document.createElement("div");a.classList.add("tile"),a.style.width=e.width-2+"px",a.style.height=e.height-2+"px",A.appendChild(a);const o=document.querySelectorAll(".tile");s.push(o[t]),t++}m.push(s)}})({width:A.clientWidth/b,height:A.clientHeight/b}),(()=>{for(let e=0;e<y.class.length;e++){let t={x:y.class.x,y:y.class.y+e};g.unshift({x:t.x,y:t.y}),m[y.class.y+e][y.class.x].classList.add("tile--snake")}})(),Y({mode:"food"})},fe=()=>{h.class.handleIsEaten(),(()=>{let e;if(re.map(((t,s)=>{t.x===y.class.x&&t.y===y.class.y&&(e={bonus:t,index:s})})),e){const{bonus:t,index:s}=e;clearInterval(re[s].boostInterval),console.log("eaten -> snake ate bonus");const a=m[t.y][t.x];if(a.classList.remove("tile--boost"),a.style.backgroundImage="",re.splice(s,1),W({type:t.name}),!v.isMuted){const e=new Audio;e.src=t.audioPATH,e.play()}}})();for(const e of H)e.handleBombCollide();if(!f.val)return;const{x:e,y:t}=g[0];if(m[y.class.y][y.class.x].classList.contains("tile--snake"))return void $();const s=m[t][e];if(s.classList.contains("tile--snake-added-point")){for(let e=0;e<g.length;e++){const{x:t,y:s}=g[e],a=m[s][t];if(!a.classList.contains("tile--snake-added-point")){a.classList.add("tile--snake-added-point");break}}s.classList.remove("tile--snake-added-point")}else if(s.classList.contains("tile--snake-subtracted-point")){for(let e=0;e<g.length;e++){const{x:t,y:s}=g[e],a=m[s][t];if(!a.classList.contains("tile--snake-subtracted-point")){a.classList.add("tile--snake-subtracted-point");break}}s.classList.remove("tile--snake-subtracted-point")}m[t][e].classList.remove("tile--snake"),g.shift(),m[y.class.y][y.class.x].classList.add("tile--snake"),g.push({x:y.class.x,y:y.class.y})},ge=()=>{Math.random()<1&&0===re.length&&(()=>{const e=u({min:0,max:100}),t=[...ne.filter((t=>t.probability>=e))];for(const e of t)Y({mode:"bonus",bonus:{name:e.name,imgPATH:oe[e.name].img,audioPATH:oe[e.name].audio}})})(),(()=>{switch(y.class.direction){case"W":y.class.y=0===y.class.y?b-1:y.class.y-1,fe();break;case"S":y.class.y=y.class.y===b-1?0:y.class.y+1,fe();break;case"A":y.class.x=0===y.class.x?b-1:y.class.x-1,fe();break;case"D":y.class.x=y.class.x===b-1?0:y.class.x+1,fe();break;default:console.error("#ERR: Nieprawidłowy kierunek!")}})(),f.val&&(y.class.jumps++,(()=>{if(y.class.jumps%(9*Math.floor(b/10))==0){y.class.speed=parseFloat((y.class.speed+.1).toFixed(2));let e=parseFloat((y.class.speed/10).toFixed(3)),t=y.class.speed%e;console.log(y.class.speed,e,t),!v.isMuted&&(y.class.speed<2||y.class.speed>=2&&0===Math.floor(y.class.speed%(y.class.speed/10)))&&de.play(),M.classList.add("parameter-speed--acceleration"),q({speed:y.class.speed.toFixed(2)}),setTimeout((()=>{M.classList.remove("parameter-speed--acceleration")}),1e3),x.val=750/(b/p.max)/4/y.class.speed,clearInterval(L.interval),L.set(setInterval(ge,x.val))}})(),I.set(!0))},ke=ge,ve=({key:e})=>{if("M"===e)return v.isMuted=!v.isMuted,void T.classList.toggle("sound--muted");"W"===e&&"S"===y.class.direction||"S"===e&&"W"===y.class.direction||"A"===e&&"D"===y.class.direction||"D"===e&&"A"===y.class.direction||(f.val||0!==y.class.jumps||("S"===e&&(g.reverse(),y.set({attr:"y",payload:g[g.length-1].y})),y.class.direction=e,f.val=!0,v.isMuted||ie.play(),x.val=750/(b/p.max)/4/y.class.speed,L.set(setInterval(ke,x.val)),w.set(setInterval((()=>{v.isMuted||ce.play(),k.time++,q({timer:k.time})}),1e3))),f.val&&I.state&&(I.set(!1),y.class.direction=e))};let xe;T.addEventListener("click",(()=>{v.isMuted=!v.isMuted,T.classList.toggle("sound--muted")})),D.forEach(((e,t)=>{e.addEventListener("touchstart",(()=>{e.classList.add("control--pressed")})),e.addEventListener("touchend",(()=>{e.classList.remove("control--pressed"),ve({key:["W","S","A","D"][t]})})),e.addEventListener("mousedown",(()=>{e.classList.add("control--pressed")})),e.addEventListener("mouseup",(()=>{e.classList.remove("control--pressed"),ve({key:["W","S","A","D"][t]})}))})),document.addEventListener("keydown",(e=>{switch(e.keyCode||e.key||e.keyIdentifier){case 87:case 38:D[0].classList.add("control--pressed");break;case 83:case 40:D[1].classList.add("control--pressed");break;case 65:case 37:D[2].classList.add("control--pressed");break;case 68:case 39:D[3].classList.add("control--pressed")}})),document.addEventListener("keyup",(e=>{let t=e.keyCode||e.key||e.keyIdentifier;switch(D.forEach((e=>e.classList.remove("control--pressed"))),t){case 87:case 38:xe="W";break;case 83:case 40:xe="S";break;case 65:case 37:xe="A";break;case 68:case 39:xe="D";break;case 77:xe="M";break;default:return}ve({key:xe})})),document.addEventListener("DOMContentLoaded",(()=>{F.set({payload:new l({boardColor:o.boardColor,textColor:o.textColor,tileColor:o.tileColor,foodColor:o.foodColor,background:o.background,snakeColor:o.snakeColor})}),he()}))})();
//# sourceMappingURL=bundle.1c0cdd527a0ed7fe72c9.js.map